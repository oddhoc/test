version: 3
projects:
- name: test
  dir: environment/test
  autoplan:
    when_modified: ["*.tf", "../../modules/s3-bucket/**/*.tf"]
    enabled: true
  workflow: atlantis
workflows:
  atlantis:
    plan:
      steps:
      - run: terraform fmt
      - init
      - run: terraform validate
      - plan:
          extra_args: ["-lock", "false"]
    apply:
      steps:
      - apply
